webpackJsonp([3,61,73,121,122],{"4Q3V":function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=t("Dd8w"),n=t.n(i),s=t("Krq1"),o=t("p1UK"),r=t("Zz1P");t.n(r).a.locale("zh-cn");var l={labelCol:{span:4},wrapperCol:{span:17}},c={wrapperCol:{xs:{span:17,offset:0},sm:{span:17,offset:4}}},d=0,u={name:"VacationAdd",components:{StaffOutsideList:s.default,StaffInsideList:o.default},props:{vacationAddVisiable:{default:!1},typeData:{require:!0}},data:function(){return{loading:!1,formItemLayout:l,formItemLayoutWithOutLabel:c,form:this.$form.createForm(this),staffOutsideList:{visiable:!1},staffInsideList:{visiable:!1},staffId:""}},created:function(){this.form=this.$form.createForm(this,{name:"dynamic_form_item"}),this.form.getFieldDecorator("keys",{initialValue:[],preserve:!0})},methods:{remove:function(e){var a=this.form,t=a.getFieldValue("keys");1!==t.length&&a.setFieldsValue({keys:t.filter(function(a){return a!==e})})},add:function(){var e=this.form,a=e.getFieldValue("keys").concat(d++);e.setFieldsValue({keys:a})},reset:function(){this.loading=!1,this.form.resetFields()},selectName:function(){var e=this.form.getFieldValue("insOut");"0"===e?this.staffInsideList.visiable=!0:"1"===e?this.staffOutsideList.visiable=!0:this.$message.warning("请先选择编制类别")},handleStaffInsideListChange:function(e,a){this.form.getFieldDecorator("name"),this.form.setFieldsValue({name:e}),this.staffId=a},handleStaffInsideListClose:function(){this.staffInsideList.visiable=!1},handleStaffOutsideListChange:function(e,a){this.form.getFieldDecorator("name"),this.form.setFieldsValue({name:e}),this.staffId=a},handleStaffOutsideListClose:function(){this.staffOutsideList.visiable=!1},onClose:function(){this.reset(),this.$emit("close")},handleSubmit:function(){var e=this;this.form.validateFields(function(a,t){if(a)e.$message.warning("格式出错，请检查表单");else{var i=0,s=[];e.form.getFieldValue("names").forEach(function(e){i=i+e[1].diff(e[0],"days")+1,s.push(e[0].format("YYYY-MM-DD")+"~"+e[1].format("YYYY-MM-DD"))});var o=n()({},t,{staffId:e.staffId,date:s.join(),day:i});e.loading=!0,e.$post("vacation",n()({},o)).then(function(a){e.reset(),e.$emit("success")}).catch(function(){e.loading=!1})}})},filterOption:function(e,a){return a.componentOptions.children[0].text.toUpperCase().indexOf(e.toUpperCase())>=0}},watch:{vacationAddVisiable:function(){this.vacationAddVisiable&&this.add()}}},f={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("a-drawer",{staticStyle:{height:"calc(100% - 55px)",overflow:"auto","padding-bottom":"53px"},attrs:{title:"新增人员休假",maskClosable:!1,width:"650",placement:"right",closable:!1,visible:e.vacationAddVisiable},on:{close:e.onClose}},[t("a-form",{attrs:{form:e.form}},[t("a-form-item",e._b({attrs:{label:"编制类别"}},"a-form-item",e.formItemLayout,!1),[t("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["insOut",{rules:[{required:!0,message:"请选择编制类别"}]}],expression:"['insOut',\n        {rules: [{ required: true, message: '请选择编制类别' }]}\n      ]"}]},[t("a-radio-button",{attrs:{value:"0"}},[e._v("编内")]),e._v(" "),t("a-radio-button",{attrs:{value:"1"}},[e._v("编外")])],1)],1),e._v(" "),t("a-form-item",e._b({attrs:{label:"选择人员"}},"a-form-item",e.formItemLayout,!1),[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请选择人员"}]}],expression:"['name',\n          {rules: [{ required: true, message: '请选择人员'}]}\n        ]"}],attrs:{readOnly:"",placeholder:"人员",autocomplete:"off"},on:{click:e.selectName}})],1),e._v(" "),t("a-form-item",e._b({attrs:{label:"休假类型"}},"a-form-item",e.formItemLayout,!1),[t("a-auto-complete",{directives:[{name:"decorator",rawName:"v-decorator",value:["type",{rules:[{required:!0,message:"休假类型不能为空"}]}],expression:"['type',\n          {rules: [{ required: true, message: '休假类型不能为空'}]}\n        ]"}],attrs:{placeholder:"休假类型",dataSource:e.typeData,allowClear:!0,filterOption:e.filterOption}})],1),e._v(" "),e._l(e.form.getFieldValue("keys"),function(a,i){return t("a-form-item",e._b({key:a,attrs:{label:0===i?"日期选择":"",required:!1}},"a-form-item",0===i?e.formItemLayout:e.formItemLayoutWithOutLabel,!1),[t("a-range-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["names["+a+"]",{rules:[{required:!0,message:"日期选择不能为空"}]}],expression:"[`names[${k}]`,\n          {rules: [{ required: true, message: '日期选择不能为空'}]}\n        ]"}],staticStyle:{width:"90%","margin-right":"8px"},attrs:{allowClear:!1}}),e._v(" "),e.form.getFieldValue("keys").length>1?t("a-icon",{staticClass:"dynamic-delete-button",attrs:{type:"minus-circle-o",disabled:1===e.form.getFieldValue("keys").length},on:{click:function(){return e.remove(a)}}}):e._e()],1)}),e._v(" "),t("a-form-item",e._b({},"a-form-item",e.formItemLayoutWithOutLabel,!1),[t("a-button",{staticStyle:{width:"60%"},attrs:{type:"dashed"},on:{click:e.add}},[t("a-icon",{attrs:{type:"plus"}}),e._v(" 添加日期选择\n      ")],1)],1),e._v(" "),t("a-form-item",e._b({attrs:{label:"备注"}},"a-form-item",e.formItemLayout,!1),[t("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["remark",{rules:[{required:!0,message:"备注不能为空"}]}],expression:"['remark',\n          {rules: [{ required: true, message: '备注不能为空'}]}\n        ]"}],attrs:{placeholder:"备注",autocomplete:"off"}})],1)],2),e._v(" "),t("div",{staticClass:"drawer-bootom-button"},[t("a-popconfirm",{attrs:{title:"确定放弃编辑？",okText:"确定",cancelText:"取消"},on:{confirm:e.onClose}},[t("a-button",{staticStyle:{"margin-right":".8rem"}},[e._v("取消")])],1),e._v(" "),t("a-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.handleSubmit}},[e._v("提交")])],1),e._v(" "),t("staff-outside-list",{attrs:{staffOutsideListVisiable:e.staffOutsideList.visiable},on:{change:e.handleStaffOutsideListChange,close:e.handleStaffOutsideListClose}}),e._v(" "),t("staff-inside-list",{attrs:{staffInsideListVisiable:e.staffInsideList.visiable},on:{change:e.handleStaffInsideListChange,close:e.handleStaffInsideListClose}})],1)},staticRenderFns:[]},m=t("VU/8")(u,f,!1,null,null,null);a.default=m.exports},"6oxv":function(e,a){},DqJ5:function(e,a){},IGQA:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=t("Dd8w"),n=t.n(i),s=t("Mc2z"),o={name:"VacationInfo",props:{vacationInfoVisiable:{default:!1},yearValue:{require:!0},viewType:{require:!0}},data:function(){return{advanced:!1,dataSource:[],paginationInfo:null,queryParams:{},pagination:{size:"small",pageSizeOptions:["20","40","80","160"],defaultCurrent:1,defaultPageSize:20,showSizeChanger:!0,showTotal:function(e){return"共 "+e+" 条"}},loading:!1}},computed:{columns:function(){return[{title:"姓名",align:"center",dataIndex:"name"},{title:"1月",align:"center",dataIndex:"january"},{title:"2月",align:"center",dataIndex:"february"},{title:"3月",align:"center",dataIndex:"march"},{title:"4月",align:"center",dataIndex:"april"},{title:"5月",align:"center",dataIndex:"may"},{title:"6月",align:"center",dataIndex:"june"},{title:"7月",align:"center",dataIndex:"july"},{title:"8月",align:"center",dataIndex:"august"},{title:"9月",align:"center",dataIndex:"september"},{title:"10月",align:"center",dataIndex:"october"},{title:"11月",align:"center",dataIndex:"november"},{title:"12月",align:"center",dataIndex:"december"}]}},methods:{onClose:function(){this.$emit("close"),this.dataSource=[]},exportExcel:function(){var e=this,a=void 0;this.pagination&&(a=this.pagination.total),this.$get("vacation/insOutVacation",n()({},this.queryParams,{pageSize:a,day:this.yearValue,insOut:this.viewType})).then(function(a){var t=[];a.data.rows.forEach(function(e){t.push([e.name,e.january,e.february,e.march,e.april,e.may,e.june,e.july,e.august,e.september,e.october,e.november,e.december])}),e.$message.loading("正在生成",3,function(){var a=Object(s.d)("Vacation");a=Object(s.a)(a,"Vacation",{title:e.yearValue+"年 编"+(0===e.viewType?"内":"外")+"休假统计"}),a=Object(s.b)(a,"Vacation",t);var i="编"+(0===e.viewType?"内":"外")+"休假统计_"+e.yearValue+".xlsx";Object(s.e)(a,i),Object(s.c)(a,"Vacation",t.length)})})},search:function(){this.fetch(n()({},this.queryParams))},reset:function(){this.$refs.TableInfo.pagination.current=this.pagination.defaultCurrent,this.paginationInfo&&(this.paginationInfo.current=this.pagination.defaultCurrent,this.paginationInfo.pageSize=this.pagination.defaultPageSize),this.paginationInfo=null,this.queryParams={},this.fetch()},handleTableChange:function(e,a,t){this.paginationInfo=e,this.fetch(n()({},this.queryParams))},fetch:function(){var e=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.loading=!0,this.paginationInfo?(this.$refs.TableInfo.pagination.current=this.paginationInfo.current,this.$refs.TableInfo.pagination.pageSize=this.paginationInfo.pageSize,a.pageSize=this.paginationInfo.pageSize,a.pageNum=this.paginationInfo.current):(a.pageSize=this.pagination.defaultPageSize,a.pageNum=this.pagination.defaultCurrent),this.$get("vacation/insOutVacation",n()({},a,{day:this.yearValue,insOut:this.viewType})).then(function(a){var t=a.data,i=n()({},e.pagination);i.total=t.total,e.loading=!1,e.dataSource=t.rows,e.pagination=i})}},watch:{vacationInfoVisiable:function(){this.vacationInfoVisiable&&this.fetch()}}},r={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("a-drawer",{staticStyle:{height:"calc(100% - 55px)",overflow:"auto","padding-bottom":"53px"},attrs:{title:e.yearValue+"年 编"+(0===e.viewType?"内":"外")+"休假统计",maskClosable:!1,width:"1300",placement:"right",visible:e.vacationInfoVisiable},on:{close:e.onClose}},[t("div",{class:e.advanced?"search":null},[t("a-form",{attrs:{layout:"horizontal"}},[t("a-row",[t("div",{class:e.advanced?null:"fold"},[t("a-col",{attrs:{md:12,sm:24}},[t("a-form-item",{attrs:{label:"姓名",labelCol:{span:5},wrapperCol:{span:18,offset:1}}},[t("a-input",{model:{value:e.queryParams.name,callback:function(a){e.$set(e.queryParams,"name",a)},expression:"queryParams.name"}})],1)],1)],1),e._v(" "),t("span",{staticStyle:{float:"right",margin:"3px auto 1em"}},[t("a-button",{attrs:{type:"primary"},on:{click:e.search}},[e._v("查询")]),e._v(" "),t("a-button",{staticStyle:{"margin-left":"8px"},on:{click:e.reset}},[e._v("重置")]),e._v("\n           \n          "),t("a-button",{attrs:{type:"primary",ghost:""},on:{click:e.exportExcel}},[e._v("导出")])],1)])],1)],1),e._v(" "),t("div",[t("a-table",{ref:"TableInfo",attrs:{bordered:"",columns:e.columns,dataSource:e.dataSource,pagination:e.pagination,loading:e.loading,rowKey:"staffId"},on:{change:e.handleTableChange}})],1)])},staticRenderFns:[]},l=t("VU/8")(o,r,!1,function(e){t("oAgZ")},"data-v-49ea1f98",null);a.default=l.exports},"M8/Z":function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=t("Dd8w"),n=t.n(i),s=t("4Q3V"),o=t("OVOK"),r=t("IGQA"),l=t("ckdc"),c=t("JpjP"),d={name:"Vacation",components:{VacationAdd:s.default,VacationEdit:o.default,VacationInfo:r.default,InsideAnnualLeave:l.default,RangeDate:c.a},data:function(){return{viewType:0,modalVisible:!1,yearValue:(new Date).getFullYear(),insOut:"0",advanced:!1,vacationAdd:{visiable:!1,data:{}},vacationEdit:{visiable:!1,data:{}},vacationInfo:{visiable:!1},insideAnnualLeave:{visiable:!1},typeData:[],queryParams:{type:[]},filteredInfo:null,sortedInfo:null,paginationInfo:null,dataSource:[],selectedRowKeys:[],loading:!1,pagination:{pageSizeOptions:["10","20","30","40","100"],defaultCurrent:1,defaultPageSize:10,showQuickJumper:!0,showSizeChanger:!0,showTotal:function(e,a){return"显示 "+a[0]+" ~ "+a[1]+" 条记录，共 "+e+" 条记录"}}}},computed:{filteredTypeOptions:function(){var e=this;return this.typeData.filter(function(a){return!e.queryParams.type.includes(a)})},columns:function(){return[{title:"姓名",dataIndex:"name"},{title:"编制类别",dataIndex:"insOut",customRender:function(e,a,t){switch(e){case"0":return"编内";case"1":return"编外";default:return e}}},{title:"休假类型",dataIndex:"type"},{title:"天数",dataIndex:"day"},{title:"备注",dataIndex:"remark"},{title:"操作",dataIndex:"operation",scopedSlots:{customRender:"operation"},fixed:"right",width:100}]}},mounted:function(){this.loadSelect()},methods:{view:function(){this.modalVisible=!1,2===this.viewType?this.insideAnnualLeave.visiable=!0:0!==this.viewType&&1!==this.viewType||(this.vacationInfo.visiable=!0)},showModal:function(e){this.viewType=e||0,this.modalVisible=!0},onSelectChange:function(e){this.selectedRowKeys=e},toggleAdvanced:function(){this.advanced=!this.advanced,this.advanced||(this.queryParams.type="",this.queryParams.createTimeFrom="",this.queryParams.createTimeTo="")},add:function(){this.vacationAdd.visiable=!0},handleVacationAddClose:function(){this.vacationAdd.visiable=!1},handleVacationAddSuccess:function(){this.vacationAdd.visiable=!1,this.$message.success("新增人员休假成功"),this.search()},edit:function(e){this.$refs.vacationEdit.setFormValues(e),this.vacationEdit.visiable=!0},handleVacationEditClose:function(){this.vacationEdit.visiable=!1},handleVacationEditSuccess:function(){this.vacationEdit.visiable=!1,this.$message.success("修改人员休假成功"),this.search()},handleVacationInfoClose:function(){this.vacationInfo.visiable=!1},handleInsideAnnualLeaveClose:function(){this.insideAnnualLeave.visiable=!1},handleTypeChange:function(e){this.queryParams.type=e||""},handleDateChange:function(e){e&&(this.queryParams.createTimeFrom=e[0],this.queryParams.createTimeTo=e[1])},batchDelete:function(){if(this.selectedRowKeys.length){var e=this;this.$confirm({title:"确定删除所选中的记录?",content:"当您点击确定按钮后，这些记录将会被彻底删除",centered:!0,onOk:function(){e.$delete("vacation/"+e.selectedRowKeys.join(",")).then(function(){e.$message.success("删除成功"),e.selectedRowKeys=[],e.search()})},onCancel:function(){e.selectedRowKeys=[]}})}else this.$message.warning("请选择需要删除的记录")},search:function(){var e=this.sortedInfo,a=this.filteredInfo,t=void 0,i=void 0;e&&(t=e.field,i=e.order),this.fetch(n()({sortField:t,sortOrder:i},this.queryParams,a))},reset:function(){this.selectedRowKeys=[],this.$refs.TableInfo.pagination.current=this.pagination.defaultCurrent,this.paginationInfo&&(this.paginationInfo.current=this.pagination.defaultCurrent,this.paginationInfo.pageSize=this.pagination.defaultPageSize),this.filteredInfo=null,this.sortedInfo=null,this.queryParams={type:[]},this.fetch()},handleTableChange:function(e,a,t){this.paginationInfo=e,this.filteredInfo=a,this.sortedInfo=t,this.fetch(n()({sortField:t.field,sortOrder:t.order},this.queryParams,a))},loadSelect:function(){var e=this;this.$get("vacation/getType",{}).then(function(a){e.typeData=a.data,e.fetch()})},fetch:function(){var e=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.loading=!0,this.paginationInfo?(this.$refs.TableInfo.pagination.current=this.paginationInfo.current,this.$refs.TableInfo.pagination.pageSize=this.paginationInfo.pageSize,a.pageSize=this.paginationInfo.pageSize,a.pageNum=this.paginationInfo.current):(a.pageSize=this.pagination.defaultPageSize,a.pageNum=this.pagination.defaultCurrent),this.$get("vacation",n()({insOut:this.insOut},a)).then(function(a){var t=a.data,i=n()({},e.pagination);i.total=t.total,e.dataSource=t.rows,e.pagination=i,e.loading=!1})}}},u={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("a-card",{staticClass:"card-area",attrs:{bordered:!1}},[t("div",{class:e.advanced?"search":null},[t("a-form",{attrs:{layout:"horizontal"}},[t("a-row",[t("div",{class:e.advanced?null:"fold"},[t("a-col",{attrs:{md:12,sm:24}},[t("a-form-item",{attrs:{label:"编制类别",labelCol:{span:5},wrapperCol:{span:18,offset:1}}},[t("a-select",{model:{value:e.insOut,callback:function(a){e.insOut=a},expression:"insOut"}},[t("a-select-option",{attrs:{value:"0"}},[e._v("编内")]),e._v(" "),t("a-select-option",{attrs:{value:"1"}},[e._v("编外")])],1)],1)],1),e._v(" "),t("a-col",{attrs:{md:12,sm:24}},[t("a-form-item",{attrs:{label:"日期",labelCol:{span:5},wrapperCol:{span:18,offset:1}}},[t("range-date",{ref:"createTime",on:{change:e.handleDateChange}})],1)],1),e._v(" "),e.advanced?[t("a-col",{attrs:{md:12,sm:24}},[t("a-form-item",{attrs:{label:"姓名",labelCol:{span:5},wrapperCol:{span:18,offset:1}}},[t("a-input",{model:{value:e.queryParams.name,callback:function(a){e.$set(e.queryParams,"name",a)},expression:"queryParams.name"}})],1)],1),e._v(" "),t("a-col",{attrs:{md:12,sm:24}},[t("a-form-item",{attrs:{label:"休假类型",labelCol:{span:5},wrapperCol:{span:18,offset:1}}},[t("a-select",{attrs:{mode:"multiple",allowClear:!0},on:{change:e.handleTypeChange}},e._l(e.filteredTypeOptions,function(a){return t("a-select-option",{key:a},[e._v(e._s(a))])}),1)],1)],1),e._v(" "),t("a-col",{attrs:{md:12,sm:24}},[t("a-form-item",{attrs:{label:"是否为假期",labelCol:{span:5},wrapperCol:{span:18,offset:1}}},[t("a-select",{model:{value:e.queryParams.isVacation,callback:function(a){e.$set(e.queryParams,"isVacation",a)},expression:"queryParams.isVacation"}},[t("a-select-option",{attrs:{value:"0"}},[e._v("是")]),e._v(" "),t("a-select-option",{attrs:{value:"1"}},[e._v("不是")])],1)],1)],1)]:e._e()],2),e._v(" "),t("span",{staticStyle:{float:"right",margin:"3px auto 1em"}},[t("a-button",{attrs:{type:"primary"},on:{click:e.search}},[e._v("查询")]),e._v(" "),t("a-button",{staticStyle:{"margin-left":"8px"},on:{click:e.reset}},[e._v("重置")]),e._v(" "),t("a",{staticStyle:{"margin-left":"8px"},on:{click:e.toggleAdvanced}},[e._v("\n            "+e._s(e.advanced?"收起":"展开")+"\n            "),t("a-icon",{attrs:{type:e.advanced?"up":"down"}})],1)],1)])],1)],1),e._v(" "),t("div",[t("div",{staticClass:"operator"},[t("a-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"vacation:add",expression:"'vacation:add'"}],attrs:{type:"primary",ghost:""},on:{click:e.add}},[e._v("新增")]),e._v(" "),t("a-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"vacation:delete",expression:"'vacation:delete'"}],on:{click:e.batchDelete}},[e._v("删除")]),e._v(" "),t("a-dropdown",[t("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[t("a-menu-item",{key:"inside-annual-leave",on:{click:function(a){return e.showModal(2)}}},[e._v("编内年假统计")]),e._v(" "),t("a-menu-item",{key:"inside-vacation",on:{click:function(a){return e.showModal(0)}}},[e._v("编内休假统计")]),e._v(" "),t("a-menu-item",{key:"outside-vacation",on:{click:function(a){return e.showModal(1)}}},[e._v("编外休假统计")])],1),e._v(" "),t("a-button",[e._v("\n          更多操作 "),t("a-icon",{attrs:{type:"down"}})],1)],1),e._v("\n       \n      "),t("a-modal",{staticStyle:{left:"-12%",top:"25%"},attrs:{title:"选择查看年份",mask:!1,maskClosable:!1,width:350,okText:"提交"},on:{ok:e.view},model:{value:e.modalVisible,callback:function(a){e.modalVisible=a},expression:"modalVisible"}},[t("a-select",{staticStyle:{width:"100%"},model:{value:e.yearValue,callback:function(a){e.yearValue=a},expression:"yearValue"}},e._l(20,function(a){return t("a-select-option",{key:2008+a},[e._v(e._s(2008+a+"年"))])}),1)],1)],1),e._v(" "),t("a-table",{ref:"TableInfo",attrs:{columns:e.columns,dataSource:e.dataSource,pagination:e.pagination,loading:e.loading,rowSelection:{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange},scroll:{x:900},rowKey:"id"},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"remark",fn:function(a){return[t("a-popover",{attrs:{placement:"topLeft"}},[t("template",{slot:"content"},[t("div",[e._v(e._s(a))])]),e._v(" "),t("p",{staticStyle:{width:"150px","margin-bottom":"0"}},[e._v(e._s(a))])],2)]}},{key:"operation",fn:function(a,i){return[t("a-icon",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"vacation:update",expression:"'vacation:update'"}],attrs:{type:"setting",theme:"twoTone",twoToneColor:"#4a9ff5",title:"修改"},on:{click:function(a){return e.edit(i)}}})]}}])})],1),e._v(" "),t("vacation-add",{attrs:{typeData:e.typeData,vacationAddVisiable:e.vacationAdd.visiable},on:{close:e.handleVacationAddClose,success:e.handleVacationAddSuccess}}),e._v(" "),t("vacation-edit",{ref:"vacationEdit",attrs:{typeData:e.typeData,vacationEditVisiable:e.vacationEdit.visiable},on:{close:e.handleVacationEditClose,success:e.handleVacationEditSuccess}}),e._v(" "),t("vacation-info",{attrs:{viewType:e.viewType,yearValue:e.yearValue,vacationInfoVisiable:e.vacationInfo.visiable},on:{close:e.handleVacationInfoClose}}),e._v(" "),t("inside-annual-leave",{attrs:{yearValue:e.yearValue,insideAnnualLeaveVisiable:e.insideAnnualLeave.visiable},on:{close:e.handleInsideAnnualLeaveClose}})],1)},staticRenderFns:[]},f=t("VU/8")(d,u,!1,function(e){t("6oxv")},"data-v-2ddc20ec",null);a.default=f.exports},OVOK:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=t("Dd8w"),n=t.n(i),s=t("fZjL"),o=t.n(s),r=t("+6Bu"),l=t.n(r),c=t("Krq1"),d=t("p1UK"),u=t("Zz1P"),f=t.n(u);f.a.locale("zh-cn");var m={labelCol:{span:4},wrapperCol:{span:17}},h={wrapperCol:{xs:{span:17,offset:0},sm:{span:17,offset:4}}},p=0,v={name:"VacationEdit",components:{StaffOutsideList:c.default,StaffInsideList:d.default},props:{vacationEditVisiable:{default:!1},typeData:{require:!0}},data:function(){return{loading:!1,formItemLayout:m,formItemLayoutWithOutLabel:h,form:this.$form.createForm(this),staffOutsideList:{visiable:!1},staffInsideList:{visiable:!1},staffId:"",id:""}},created:function(){this.form=this.$form.createForm(this,{name:"dynamic_form_item"}),this.form.getFieldDecorator("keys",{initialValue:[],preserve:!0})},methods:{remove:function(e){var a=this.form,t=a.getFieldValue("keys");1!==t.length&&a.setFieldsValue({keys:t.filter(function(a){return a!==e})})},add:function(){var e=this.form,a=e.getFieldValue("keys").concat(p++);e.setFieldsValue({keys:a})},reset:function(){this.loading=!1,this.form.resetFields()},setFormValues:function(e){var a=this,t=l()(e,[]);this.id=t.id;var i={};o()(t).forEach(function(e){a.form.getFieldDecorator(e),i[e]=t[e]});var n=t.date.split(",");i.keys=[],i.names=[],n.forEach(function(e,t){a.form.getFieldDecorator("names["+t+"]"),i.keys=i.keys.concat(p++),i.names.push(e.split("~").map(function(e){return f()(e)}))}),this.form.setFieldsValue(i)},selectName:function(){var e=this.form.getFieldValue("insOut");"0"===e?this.staffInsideList.visiable=!0:"1"===e?this.staffOutsideList.visiable=!0:this.$message.warning("请先选择编制类别")},handleStaffInsideListChange:function(e,a){this.form.getFieldDecorator("name"),this.form.setFieldsValue({name:e}),this.staffId=a},handleStaffInsideListClose:function(){this.staffInsideList.visiable=!1},handleStaffOutsideListChange:function(e,a){this.form.getFieldDecorator("name"),this.form.setFieldsValue({name:e}),this.staffId=a},handleStaffOutsideListClose:function(){this.staffOutsideList.visiable=!1},onClose:function(){this.reset(),this.$emit("close")},handleSubmit:function(){var e=this;this.form.validateFields(function(a,t){if(a)e.$message.warning("格式出错，请检查表单");else{var i=0,s=[];e.form.getFieldValue("names").forEach(function(e){i=i+e[1].diff(e[0],"days")+1,s.push(e[0].format("YYYY-MM-DD")+"~"+e[1].format("YYYY-MM-DD"))});var o=n()({},t,{id:e.id,staffId:e.staffId,date:s.join(),day:i});e.loading=!0,e.$put("vacation",n()({},o)).then(function(a){e.reset(),e.$emit("success")}).catch(function(){e.loading=!1})}})},filterOption:function(e,a){return a.componentOptions.children[0].text.toUpperCase().indexOf(e.toUpperCase())>=0}}},g={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("a-drawer",{staticStyle:{height:"calc(100% - 55px)",overflow:"auto","padding-bottom":"53px"},attrs:{title:"修改人员休假",maskClosable:!1,width:"650",placement:"right",closable:!1,visible:e.vacationEditVisiable},on:{close:e.onClose}},[t("a-form",{attrs:{form:e.form}},[t("a-form-item",e._b({attrs:{label:"编制类别"}},"a-form-item",e.formItemLayout,!1),[t("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["insOut",{rules:[{required:!0,message:"请选择编制类别"}]}],expression:"['insOut',\n        {rules: [{ required: true, message: '请选择编制类别' }]}\n      ]"}]},[t("a-radio-button",{attrs:{value:"0"}},[e._v("编内")]),e._v(" "),t("a-radio-button",{attrs:{value:"1"}},[e._v("编外")])],1)],1),e._v(" "),t("a-form-item",e._b({attrs:{label:"选择人员"}},"a-form-item",e.formItemLayout,!1),[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请选择人员"}]}],expression:"['name',\n          {rules: [{ required: true, message: '请选择人员'}]}\n        ]"}],attrs:{readOnly:"",placeholder:"人员",autocomplete:"off"},on:{click:e.selectName}})],1),e._v(" "),t("a-form-item",e._b({attrs:{label:"休假类型"}},"a-form-item",e.formItemLayout,!1),[t("a-auto-complete",{directives:[{name:"decorator",rawName:"v-decorator",value:["type",{rules:[{required:!0,message:"休假类型不能为空"}]}],expression:"['type',\n          {rules: [{ required: true, message: '休假类型不能为空'}]}\n        ]"}],attrs:{placeholder:"休假类型",dataSource:e.typeData,allowClear:!0,filterOption:e.filterOption}})],1),e._v(" "),e._l(e.form.getFieldValue("keys"),function(a,i){return t("a-form-item",e._b({key:a,attrs:{label:0===i?"日期选择":"",required:!1}},"a-form-item",0===i?e.formItemLayout:e.formItemLayoutWithOutLabel,!1),[t("a-range-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["names["+a+"]",{rules:[{required:!0,message:"日期选择不能为空"}]}],expression:"[`names[${k}]`,\n          {rules: [{ required: true, message: '日期选择不能为空'}]}\n        ]"}],staticStyle:{width:"90%","margin-right":"8px"},attrs:{allowClear:!1}}),e._v(" "),e.form.getFieldValue("keys").length>1?t("a-icon",{staticClass:"dynamic-delete-button",attrs:{type:"minus-circle-o",disabled:1===e.form.getFieldValue("keys").length},on:{click:function(){return e.remove(a)}}}):e._e()],1)}),e._v(" "),t("a-form-item",e._b({},"a-form-item",e.formItemLayoutWithOutLabel,!1),[t("a-button",{staticStyle:{width:"60%"},attrs:{type:"dashed"},on:{click:e.add}},[t("a-icon",{attrs:{type:"plus"}}),e._v(" 添加日期选择\n      ")],1)],1),e._v(" "),t("a-form-item",e._b({attrs:{label:"备注"}},"a-form-item",e.formItemLayout,!1),[t("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["remark",{rules:[{required:!0,message:"备注不能为空"}]}],expression:"['remark',\n          {rules: [{ required: true, message: '备注不能为空'}]}\n        ]"}],attrs:{placeholder:"备注",autocomplete:"off"}})],1)],2),e._v(" "),t("div",{staticClass:"drawer-bootom-button"},[t("a-popconfirm",{attrs:{title:"确定放弃编辑？",okText:"确定",cancelText:"取消"},on:{confirm:e.onClose}},[t("a-button",{staticStyle:{"margin-right":".8rem"}},[e._v("取消")])],1),e._v(" "),t("a-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.handleSubmit}},[e._v("提交")])],1),e._v(" "),t("staff-outside-list",{attrs:{staffOutsideListVisiable:e.staffOutsideList.visiable},on:{change:e.handleStaffOutsideListChange,close:e.handleStaffOutsideListClose}}),e._v(" "),t("staff-inside-list",{attrs:{staffInsideListVisiable:e.staffInsideList.visiable},on:{change:e.handleStaffInsideListChange,close:e.handleStaffInsideListClose}})],1)},staticRenderFns:[]},y=t("VU/8")(v,g,!1,null,null,null);a.default=y.exports},ckdc:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=t("Dd8w"),n=t.n(i),s=t("Mc2z"),o={name:"InsideAnnualLeave",props:{insideAnnualLeaveVisiable:{default:!1},yearValue:{require:!0}},data:function(){return{advanced:!1,dataSource:[],paginationInfo:null,queryParams:{},pagination:{size:"small",pageSizeOptions:["20","40","80","160"],defaultCurrent:1,defaultPageSize:20,showSizeChanger:!0,showTotal:function(e){return"共 "+e+" 条"}},loading:!1}},computed:{columns:function(){return[{title:"姓名",align:"center",dataIndex:"name"},{title:"参工日期",align:"center",dataIndex:"workDate"},{title:"工作年限",align:"center",dataIndex:"workingYears"},{title:"可休天数",align:"center",dataIndex:"vacationDays"},{title:"已休天数",align:"center",dataIndex:"alreadyDays"},{title:"剩余天数",align:"center",dataIndex:"remainingDays"},{title:"1月",align:"center",dataIndex:"january"},{title:"2月",align:"center",dataIndex:"february"},{title:"3月",align:"center",dataIndex:"march"},{title:"4月",align:"center",dataIndex:"april"},{title:"5月",align:"center",dataIndex:"may"},{title:"6月",align:"center",dataIndex:"june"},{title:"7月",align:"center",dataIndex:"july"},{title:"8月",align:"center",dataIndex:"august"},{title:"9月",align:"center",dataIndex:"september"},{title:"10月",align:"center",dataIndex:"october"},{title:"11月",align:"center",dataIndex:"november"},{title:"12月",align:"center",dataIndex:"december"}]}},methods:{onClose:function(){this.$emit("close"),this.dataSource=[]},exportExcel:function(){var e=this,a=void 0;this.pagination&&(a=this.pagination.total),this.$get("vacation/insideAnnualLeave",n()({},this.queryParams,{pageSize:a,day:this.yearValue})).then(function(a){var t=[];a.data.rows.forEach(function(a){a.workDate&&(a.workingYears=e.$tools.getAge(a.workDate),a.vacationDays=a.workingYears>=20?15:a.workingYears>=10?10:a.workingYears>=1?5:0,a.remainingDays=a.vacationDays-a.alreadyDays),t.push([a.name,a.workDate,a.workingYears,a.vacationDays,a.alreadyDays,a.remainingDays,a.january,a.february,a.march,a.april,a.may,a.june,a.july,a.august,a.september,a.october,a.november,a.december])}),e.$message.loading("正在生成",3,function(){var a=Object(s.d)("InsideAnnualLeave");a=Object(s.a)(a,"InsideAnnualLeave",{title:e.yearValue+"年编内人员年假统计"}),a=Object(s.b)(a,"InsideAnnualLeave",t);var i="编内人员年假统计_"+e.yearValue+".xlsx";Object(s.e)(a,i),Object(s.c)(a,"InsideAnnualLeave",t.length)})})},search:function(){this.fetch(n()({},this.queryParams))},reset:function(){this.$refs.TableInfo.pagination.current=this.pagination.defaultCurrent,this.paginationInfo&&(this.paginationInfo.current=this.pagination.defaultCurrent,this.paginationInfo.pageSize=this.pagination.defaultPageSize),this.paginationInfo=null,this.queryParams={},this.fetch()},handleTableChange:function(e,a,t){this.paginationInfo=e,this.fetch(n()({},this.queryParams))},fetch:function(){var e=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.loading=!0,this.paginationInfo?(this.$refs.TableInfo.pagination.current=this.paginationInfo.current,this.$refs.TableInfo.pagination.pageSize=this.paginationInfo.pageSize,a.pageSize=this.paginationInfo.pageSize,a.pageNum=this.paginationInfo.current):(a.pageSize=this.pagination.defaultPageSize,a.pageNum=this.pagination.defaultCurrent),this.$get("vacation/insideAnnualLeave",n()({},a,{day:this.yearValue})).then(function(a){e.dataSource=[];var t=a.data,i=n()({},e.pagination);i.total=t.total,e.loading=!1,t.rows.forEach(function(a){a.workDate&&(a.workingYears=e.$tools.getAge(a.workDate),a.vacationDays=a.workingYears>=20?15:a.workingYears>=10?10:a.workingYears>=1?5:0,a.remainingDays=a.vacationDays-a.alreadyDays),e.dataSource.push(a)}),e.pagination=i})}},watch:{insideAnnualLeaveVisiable:function(){this.insideAnnualLeaveVisiable&&this.fetch()}}},r={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("a-drawer",{staticStyle:{height:"calc(100% - 55px)",overflow:"auto","padding-bottom":"53px"},attrs:{title:e.yearValue+"年 编内年假统计",maskClosable:!1,width:"1300",placement:"right",visible:e.insideAnnualLeaveVisiable},on:{close:e.onClose}},[t("div",{class:e.advanced?"search":null},[t("a-form",{attrs:{layout:"horizontal"}},[t("a-row",[t("div",{class:e.advanced?null:"fold"},[t("a-col",{attrs:{md:12,sm:24}},[t("a-form-item",{attrs:{label:"姓名",labelCol:{span:5},wrapperCol:{span:18,offset:1}}},[t("a-input",{model:{value:e.queryParams.name,callback:function(a){e.$set(e.queryParams,"name",a)},expression:"queryParams.name"}})],1)],1)],1),e._v(" "),t("span",{staticStyle:{float:"right",margin:"3px auto 1em"}},[t("a-button",{attrs:{type:"primary"},on:{click:e.search}},[e._v("查询")]),e._v(" "),t("a-button",{staticStyle:{"margin-left":"8px"},on:{click:e.reset}},[e._v("重置")]),e._v("\n           \n          "),t("a-button",{attrs:{type:"primary",ghost:""},on:{click:e.exportExcel}},[e._v("导出")])],1)])],1)],1),e._v(" "),t("div",[t("a-table",{ref:"TableInfo",attrs:{bordered:"",columns:e.columns,dataSource:e.dataSource,pagination:e.pagination,loading:e.loading,rowKey:"staffId"},on:{change:e.handleTableChange}})],1)])},staticRenderFns:[]},l=t("VU/8")(o,r,!1,function(e){t("DqJ5")},"data-v-6d537754",null);a.default=l.exports},oAgZ:function(e,a){}});