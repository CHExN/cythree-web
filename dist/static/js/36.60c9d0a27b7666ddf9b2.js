webpackJsonp([36,47],{"Xe/P":function(t,a){},Z7UB:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var o=e("bOdI"),n=e.n(o),i=e("Dd8w"),r=e.n(i),s=e("fZjL"),l=e.n(s),u=e("mvHQ"),c=e.n(u),m=e("JpjP"),d=e("gmrb"),p=e("Mc2z"),f={name:"StoreroomItemDetails",components:{RangeDate:m.a,StoreroomItemDetailsInfo:d.default},data:function(){return{advanced:!1,radioValue:!0,yearValue:(new Date).getFullYear(),yearIs:0,modalVisible:!1,dateData:{dateForm:{},dateTo:{}},dateTitle:"",dictData:{},storeroomItemDetailsInfo:{visiable:!1,data:{}},dataSource:[],paginationInfo:null,pagination:{pageSizeOptions:["10","20","30","40","100"],defaultCurrent:1,defaultPageSize:10,showQuickJumper:!0,showSizeChanger:!0,showTotal:function(t,a){return"显示 "+a[0]+" ~ "+a[1]+" 条记录，共 "+t+" 条记录"}},queryParams:{createTimeFrom:"",createTimeTo:""},loading:!1}},computed:{columns:function(){var t=this;return[{title:"物品名称",dataIndex:"name"},{title:"型号",dataIndex:"type"},{title:"入库数量",dataIndex:"amount",scopedSlots:{customRender:"amount"}},{title:"单位",dataIndex:"unit"},{title:"单价",dataIndex:"money",scopedSlots:{customRender:"money"}},{title:"物资类别",dataIndex:"typeApplication",customRender:function(a,e,o){return t.dictData.typeApplication[a]}},{title:"供应商",dataIndex:"supplier",customRender:function(a,e,o){return t.dictData.supplier[a]}},{title:"入库日期",dataIndex:"date"},{title:"入库单号",dataIndex:"putNum"},{title:"操作",dataIndex:"operation",scopedSlots:{customRender:"operation"},fixed:"right",width:100}]}},mounted:function(){this.loadSelect()},methods:{showModal:function(){this.modalVisible=!0},viewDist:function(){var t=this;if(this.radioValue)if("{}"!==c()(this.dateData.dateForm)){this.$message.loading("正在生成",0),this.modalVisible=!1;var a=[];this.$get("wc/wcCostAccount",{year:this.dateData.dateForm.year,month:this.dateData.dateForm.month}).then(function(e){e.data.forEach(function(o,n){if(a.push([t.dictData.wcSort[o.wcSort],o.wcOwn,o.wcNum,o.wcName,o.a,o.b,o.c,o.d,o.e,o.f,o.g]),a.length===e.data.length){t.$message.destroy();var i=Object(p.d)("WcCostAccount");i=Object(p.a)(i,"WcCostAccount",{title:"朝环三队"+t.dateTitle+"公厕成本核算台帐"}),i=Object(p.b)(i,"WcCostAccount",a);var r="朝环三队"+t.dateTitle+"公厕成本核算台帐.xlsx";Object(p.e)(i,r),Object(p.c)(i,"WcCostAccount",a.length)}})})}else this.$message.warning("请选择查看月份");else{this.$message.loading("正在生成",0),this.modalVisible=!1;var e=[];this.$get("wc/findWcCostAccountByYear",{year:this.yearValue,up:this.yearIs}).then(function(a){if(a.data.forEach(function(a,o){e.push([t.dictData.wcSort[a.wcSort],a.wcOwn,a.wcNum,a.wcName,a.a,a.b,a.c,a.d,null,a.e,a.f,a.g,a.h,a.i,a.j,null,a.k,a.l,a.m,a.n,a.o,a.p])}),e.length===a.data.length){t.$message.destroy();var o=0===t.yearIs?"WcCostAccountFirstHalf":"WcCostAccountSecondHalf",n=Object(p.d)(o);n=Object(p.a)(n,o,{title:"朝环三队"+t.yearValue+"年"+(0===t.yearIs?"01~06月":"07~12月")+"公厕成本核算台帐"}),n=Object(p.b)(n,o,e);var i="朝环三队"+t.yearValue+"年"+(0===t.yearIs?"01~06月":"07~12月")+"公厕成本核算台帐.xlsx";Object(p.e)(n,i),Object(p.c)(n,o,e.length)}})}},onRadioChange:function(t){this.dateData={dateForm:{},dateTo:{}}},handleMonthChange:function(t){if(!t)return this.dateData.dateForm={},void(this.dateTitle="");this.dateData.dateForm={year:t.format("YYYY"),month:t.format("MM")},this.dateTitle=t.format("YYYY年MM月")},toggleAdvanced:function(){this.advanced=!this.advanced,this.advanced||(this.queryParams.name="",this.queryParams.putNum="",this.queryParams.unit="",this.queryParams.receipt="",this.queryParams.createTimeFrom="",this.queryParams.createTimeTo="",this.queryParams.remark="")},view:function(t){var a=this;l()(this.dictData).forEach(function(e){t[e+"ToDict"]=a.dictData[e][t[e]]}),this.storeroomItemDetailsInfo.data=t,this.storeroomItemDetailsInfo.visiable=!0},handleStoreroomItemDetailsInfoClose:function(){this.storeroomItemDetailsInfo.visiable=!1},handleTypeApplicationChange:function(t){this.queryParams.typeApplication=t||""},handleSupplierChange:function(t){this.queryParams.supplier=t||""},handleDateChange:function(t){t&&(this.queryParams.createTimeFrom=t[0],this.queryParams.createTimeTo=t[1])},search:function(){this.fetch(r()({},this.queryParams))},reset:function(){this.$refs.TableInfo.pagination.current=this.pagination.defaultCurrent,this.paginationInfo&&(this.paginationInfo.current=this.pagination.defaultCurrent,this.paginationInfo.pageSize=this.pagination.defaultPageSize),this.paginationInfo=null,this.queryParams={createTimeFrom:"",createTimeTo:""},this.advanced&&this.$refs.createTime.reset(),this.fetch()},handleTableChange:function(t,a,e){this.paginationInfo=t,this.fetch(r()({},this.queryParams))},loadSelect:function(){var t=this;this.$get("supplier/all",{}).then(function(a){var e={};a.data.forEach(function(t){e.supplier?e.supplier[t.id]=t.name:e.supplier=n()({},t.id,t.name)}),t.dictData=r()({},t.dictData,e)}),this.$get("dict/cy_wc",{}).then(function(a){var e={};a.data.forEach(function(a){var o=t.$tools.toHump(a.fieldName.toLowerCase());e[o]?e[o][a.keyy]=a.valuee:e[o]=n()({},a.keyy,a.valuee)}),t.dictData=r()({},e,t.dictData)}),this.$get("dict/cy_storeroom",{}).then(function(a){var e={};a.data.forEach(function(a){var o=t.$tools.toHump(a.fieldName.toLowerCase());e[o]?e[o][a.keyy]=a.valuee:e[o]=n()({},a.keyy,a.valuee)}),t.dictData=r()({},e,t.dictData),t.fetch()})},fetch:function(){var t=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.loading=!0,this.paginationInfo?(this.$refs.TableInfo.pagination.current=this.paginationInfo.current,this.$refs.TableInfo.pagination.pageSize=this.paginationInfo.pageSize,a.pageSize=this.paginationInfo.pageSize,a.pageNum=this.paginationInfo.current):(a.pageSize=this.pagination.defaultPageSize,a.pageNum=this.pagination.defaultCurrent),this.$get("storeroom/itemDetails",r()({},a)).then(function(a){var e=a.data,o=r()({},t.pagination);o.total=e.total,t.loading=!1,t.dataSource=e.rows,t.pagination=o})}}},h={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("a-card",{staticClass:"card-area",attrs:{bordered:!1}},[e("div",{class:t.advanced?"search":null},[e("a-form",{attrs:{layout:"horizontal"}},[e("a-row",[e("div",{class:t.advanced?null:"fold"},[e("a-col",{attrs:{md:12,sm:24}},[e("a-form-item",{attrs:{label:"物资类别",labelCol:{span:5},wrapperCol:{span:18,offset:1}}},[e("a-select",{attrs:{mode:"multiple",allowClear:!0},on:{change:t.handleTypeApplicationChange}},t._l(Object.keys(t.dictData.typeApplication||[]),function(a){return e("a-select-option",{key:a},[t._v(t._s(t.dictData.typeApplication[a]))])}),1)],1)],1),t._v(" "),e("a-col",{attrs:{md:12,sm:24}},[e("a-form-item",{attrs:{label:"供应商",labelCol:{span:5},wrapperCol:{span:18,offset:1}}},[e("a-select",{attrs:{mode:"multiple",allowClear:!0},on:{change:t.handleSupplierChange}},t._l(Object.keys(t.dictData.supplier||[]),function(a){return e("a-select-option",{key:a},[t._v(t._s(t.dictData.supplier[a]))])}),1)],1)],1),t._v(" "),t.advanced?[e("a-col",{attrs:{md:12,sm:24}},[e("a-form-item",{attrs:{label:"物品名称",labelCol:{span:5},wrapperCol:{span:18,offset:1}}},[e("a-input",{model:{value:t.queryParams.name,callback:function(a){t.$set(t.queryParams,"name",a)},expression:"queryParams.name"}})],1)],1),t._v(" "),e("a-col",{attrs:{md:12,sm:24}},[e("a-form-item",{attrs:{label:"入库单号",labelCol:{span:5},wrapperCol:{span:18,offset:1}}},[e("a-input",{model:{value:t.queryParams.putNum,callback:function(a){t.$set(t.queryParams,"putNum",a)},expression:"queryParams.putNum"}})],1)],1),t._v(" "),e("a-col",{attrs:{md:12,sm:24}},[e("a-form-item",{attrs:{label:"型号",labelCol:{span:5},wrapperCol:{span:18,offset:1}}},[e("a-input",{model:{value:t.queryParams.type,callback:function(a){t.$set(t.queryParams,"type",a)},expression:"queryParams.type"}})],1)],1),t._v(" "),e("a-col",{attrs:{md:12,sm:24}},[e("a-form-item",{attrs:{label:"收据",labelCol:{span:5},wrapperCol:{span:18,offset:1}}},[e("a-input",{model:{value:t.queryParams.receipt,callback:function(a){t.$set(t.queryParams,"receipt",a)},expression:"queryParams.receipt"}})],1)],1),t._v(" "),e("a-col",{attrs:{md:12,sm:24}},[e("a-form-item",{attrs:{label:"入库日期",labelCol:{span:5},wrapperCol:{span:18,offset:1}}},[e("range-date",{ref:"createTime",on:{change:t.handleDateChange}})],1)],1),t._v(" "),e("a-col",{attrs:{md:12,sm:24}},[e("a-form-item",{attrs:{label:"备注",labelCol:{span:5},wrapperCol:{span:18,offset:1}}},[e("a-input",{model:{value:t.queryParams.remark,callback:function(a){t.$set(t.queryParams,"remark",a)},expression:"queryParams.remark"}})],1)],1)]:t._e()],2),t._v(" "),e("span",{staticStyle:{float:"right",margin:"3px auto 1em"}},[e("a-button",{attrs:{type:"primary"},on:{click:t.search}},[t._v("查询")]),t._v(" "),e("a-button",{staticStyle:{"margin-left":"8px"},on:{click:t.reset}},[t._v("重置")]),t._v(" "),e("a",{staticStyle:{"margin-left":"8px"},on:{click:t.toggleAdvanced}},[t._v("\n            "+t._s(t.advanced?"收起":"展开")+"\n            "),e("a-icon",{attrs:{type:t.advanced?"up":"down"}})],1)],1)])],1)],1),t._v(" "),e("div",[e("div",{staticClass:"operator"},[e("a-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"wcAccount:export",expression:"'wcAccount:export'"}],attrs:{type:"primary",ghost:""},on:{click:t.showModal}},[t._v("导出公厕台账")]),t._v("\n       \n      "),e("a-modal",{staticStyle:{left:"-12%",top:"25%"},attrs:{title:"选择导出日期",mask:!1,maskClosable:!1,width:350,okText:"提交"},on:{ok:t.viewDist},model:{value:t.modalVisible,callback:function(a){t.modalVisible=a},expression:"modalVisible"}},[e("div",{staticStyle:{width:"100%","margin-top":"-20px","margin-bottom":"10px"}},[e("a-radio-group",{on:{change:t.onRadioChange},model:{value:t.radioValue,callback:function(a){t.radioValue=a},expression:"radioValue"}},[e("a-radio-button",{attrs:{value:!0}},[t._v("月选")]),t._v(" "),e("a-radio-button",{attrs:{value:!1}},[t._v("年选")])],1)],1),t._v(" "),t.radioValue?e("a-month-picker",{staticStyle:{width:"100%"},on:{change:t.handleMonthChange}}):[e("a-select",{staticStyle:{width:"151px"},model:{value:t.yearValue,callback:function(a){t.yearValue=a},expression:"yearValue"}},t._l(20,function(a){return e("a-select-option",{key:2008+a},[t._v(t._s(2008+a+"年"))])}),1),t._v(" "),e("a-radio-group",{model:{value:t.yearIs,callback:function(a){t.yearIs=a},expression:"yearIs"}},[e("a-radio-button",{attrs:{value:0}},[t._v("上半年")]),t._v(" "),e("a-radio-button",{attrs:{value:1}},[t._v("下半年")])],1)]],2)],1),t._v(" "),e("a-table",{ref:"TableInfo",attrs:{columns:t.columns,dataSource:t.dataSource,pagination:t.pagination,loading:t.loading,scroll:{x:900},rowKey:"id"},on:{change:t.handleTableChange},scopedSlots:t._u([{key:"amount",fn:function(a){return[e("span",[t._v(t._s(t.$tools.toNumFormant(a)))])]}},{key:"money",fn:function(a){return[e("span",[t._v(t._s(t.$tools.addZero(t.$tools.toNumFormant(a))))])]}},{key:"operation",fn:function(a,o){return[e("a-icon",{attrs:{type:"eye",theme:"twoTone",twoToneColor:"#42b983",title:"查看"},on:{click:function(a){return t.view(o)}}})]}}])})],1),t._v(" "),e("storeroom-item-details-info",{attrs:{storeroomItemDetailsInfoData:t.storeroomItemDetailsInfo.data,storeroomItemDetailsInfoVisiable:t.storeroomItemDetailsInfo.visiable},on:{close:t.handleStoreroomItemDetailsInfoClose}})],1)},staticRenderFns:[]},I=e("VU/8")(f,h,!1,function(t){e("Xe/P")},"data-v-516dab2c",null);a.default=I.exports},gmrb:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var o=e("dC1H"),n=e("et8n"),i=o.a.Item,r={components:{AStepItemGroup:n.a.Group,AStepItem:n.a,DetailListItem:i,DetailList:o.a},name:"StoreroomItemDetailsInfo",props:{storeroomItemDetailsInfoVisiable:{require:!0,default:!1},storeroomItemDetailsInfoData:{require:!0}},data:function(){return{dataSource:[],loading:!1}},computed:{columns:function(){return[{title:"日期",dataIndex:"date"},{title:"摘要",dataIndex:"info",scopedSlots:{customRender:"info"}},{title:"收入",children:[{title:"数量",dataIndex:"quantityPut"},{title:"单价",dataIndex:"unitPricePut"},{title:"金额",dataIndex:"amountPut"}]},{title:"发出",children:[{title:"数量",dataIndex:"quantityOut"},{title:"单价",dataIndex:"unitPriceOut"},{title:"金额",dataIndex:"amountOut"}]},{title:"结存",children:[{title:"数量",dataIndex:"quantity"},{title:"单价",dataIndex:"unitPrice"},{title:"金额",dataIndex:"amount"}]}]}},methods:{handleCancleClick:function(){this.dataSource=[],this.loading=!1,this.$emit("close")}},watch:{storeroomItemDetailsInfoVisiable:function(){var t=this;this.storeroomItemDetailsInfoVisiable&&(this.loading=!0,this.$get("storeroom/storeroomOutItem",{parentId:this.storeroomItemDetailsInfoData.parentId,id:this.storeroomItemDetailsInfoData.id}).then(function(a){t.loading=!1,t.dataSource.push({date:t.storeroomItemDetailsInfoData.date,info:"进"+t.storeroomItemDetailsInfoData.name,quantityPut:t.storeroomItemDetailsInfoData.amount,unitPricePut:t.storeroomItemDetailsInfoData.money,amountPut:t.$tools.accMul(t.storeroomItemDetailsInfoData.amount,t.storeroomItemDetailsInfoData.money),quantityOut:null,unitPriceOut:null,amountOut:null,quantity:null,unitPrice:null,amount:null});var e=t.dataSource[0].quantityPut,o=t.dataSource[0].amountPut,n=0,i=0;a.data.forEach(function(r,s){t.dataSource[0].date.split("-")[1]!==r.date.split("-")[1]&&(t.dataSource.push({date:null,info:"本月合计",quantityPut:t.storeroomItemDetailsInfoData.amount,unitPricePut:t.storeroomItemDetailsInfoData.money,amountPut:t.$tools.accMul(t.storeroomItemDetailsInfoData.amount,t.storeroomItemDetailsInfoData.money),quantityOut:n,unitPriceOut:t.storeroomItemDetailsInfoData.money,amountOut:i,quantity:e,unitPrice:0===e?"":t.storeroomItemDetailsInfoData.money,amount:o}),n=0,i=0),e-=r.amount,o-=t.$tools.accMul(r.amount,r.money),n+=r.amount,i+=t.$tools.accMul(r.amount,r.money),t.dataSource.push({date:r.date,info:"付"+r.toDeptName,quantityPut:null,unitPricePut:null,amountPut:null,quantityOut:r.amount,unitPriceOut:r.money,amountOut:t.$tools.accMul(r.amount,r.money),quantity:null,unitPrice:null,amount:null}),a.data.length===s+1&&(t.dataSource.push({date:null,info:"本月合计",quantityPut:0,unitPricePut:0,amountPut:0,quantityOut:n,unitPriceOut:t.storeroomItemDetailsInfoData.money,amountOut:i,quantity:e,unitPrice:0===e?0:t.storeroomItemDetailsInfoData.money,amount:o}),n=0,i=0)})}))}}},s={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("a-modal",{attrs:{title:"出入库物品明细信息",centered:!0,width:1e3,visible:t.storeroomItemDetailsInfoVisiable,keyboard:!1,footer:null},on:{cancel:t.handleCancleClick}},[e("a-card",{staticStyle:{"margin-bottom":"32px"},attrs:{bordered:!1}},[e("detail-list",[e("detail-list-item",{attrs:{term:"物品名称"}},[t._v(t._s(t.storeroomItemDetailsInfoData.name))]),t._v(" "),e("detail-list-item",{attrs:{term:"型号"}},[t._v(t._s(t.storeroomItemDetailsInfoData.unit))]),t._v(" "),e("detail-list-item",{attrs:{term:"入库数量"}},[t._v(t._s(t.storeroomItemDetailsInfoData.amount))]),t._v(" "),e("detail-list-item",{attrs:{term:"单位"}},[t._v(t._s(t.storeroomItemDetailsInfoData.unit))]),t._v(" "),e("detail-list-item",{attrs:{term:"单价"}},[t._v(t._s(t.$tools.addZero(t.$tools.toNumFormant(t.storeroomItemDetailsInfoData.money))))]),t._v(" "),e("detail-list-item",{attrs:{term:"物资类别"}},[t._v(t._s(t.storeroomItemDetailsInfoData.typeApplicationToDict))]),t._v(" "),e("detail-list-item",{attrs:{term:"供应商"}},[t._v(t._s(t.storeroomItemDetailsInfoData.supplierToDict))]),t._v(" "),e("detail-list-item",{attrs:{term:"入库日期"}},[t._v(t._s(t.storeroomItemDetailsInfoData.date))]),t._v(" "),e("detail-list-item",{attrs:{term:"入库单号"}},[t._v(t._s(t.storeroomItemDetailsInfoData.putNum))])],1),t._v(" "),e("a-divider",{staticStyle:{"margin-bottom":"32px"}}),t._v(" "),e("detail-list",{attrs:{title:"进付明细"}},[e("a-table",{ref:"TableInfo",attrs:{bordered:"",columns:t.columns,dataSource:t.dataSource,pagination:!1,loading:t.loading},scopedSlots:t._u([{key:"info",fn:function(a){return["进"===a.charAt(0)?e("span",[t._v("\n            进 "),e("a-tag",{attrs:{color:"cyan"}},[t._v(t._s(a.substring(1)||a))])],1):"付"===a.charAt(0)?e("span",[t._v("\n            付 "),e("a-tag",{attrs:{color:"purple"}},[t._v(t._s(a.substring(1)||a))])],1):e("span",[t._v(t._s(a))])]}}])})],1)],1)],1)},staticRenderFns:[]},l=e("VU/8")(r,s,!1,function(t){e("jAcF")},"data-v-d7d70504",null);a.default=l.exports},jAcF:function(t,a){}});