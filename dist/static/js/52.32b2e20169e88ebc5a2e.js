webpackJsonp([52],{ITj1:function(t,e){},JMfY:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("Gu7T"),i=n.n(a),o=n("mvHQ"),r=n.n(o),c=n("Dd8w"),u=n.n(c),s=n("SJI6"),l={labelCol:{span:4},wrapperCol:{span:17,offset:1}},d={name:"OfficeSuppliesAdd",props:{officeSuppliesAddVisiable:{default:!1}},data:function(){return{loading:!1,formItemLayout:l,dataSource:[],tableIndex:0}},computed:u()({},Object(s.mapState)({user:function(t){return t.account.user}}),{columns:function(){return[{title:"物品名称",dataIndex:"name",width:"20%",scopedSlots:{customRender:"name"}},{title:"型号",dataIndex:"type",width:"15%",scopedSlots:{customRender:"type"}},{title:"数量",dataIndex:"amount",width:"15%",scopedSlots:{customRender:"amount"}},{title:"单位",dataIndex:"unit",width:"12%",scopedSlots:{customRender:"unit"}},{title:"备注",dataIndex:"remark",width:"23%",scopedSlots:{customRender:"remark"}},{title:"操作",dataIndex:"action",scopedSlots:{customRender:"operation"}}]}}),methods:{reset:function(){this.loading=!1,this.dataSource=[]},onClose:function(){this.reset(),this.$emit("close")},handleSubmit:function(){var t=this,e=[];if(this.dataSource.forEach(function(t){!1===t.isNew&&!1===t.editable&&e.push(t)}),0!==e.length){var n=r()(e,function(t,e){return"key"===t||"editable"===t||"isNew"===t?void 0:e});this.loading=!0,this.$post("application",{typeApplication:3,deptId:this.user.deptId,planList:n}).then(function(e){t.reset(),t.$emit("success")}).catch(function(){t.loading=!1})}else this.$message.warning("计划单至少要有一条数据")},newRow:function(){this.tableIndex++,this.dataSource.push({key:this.tableIndex,name:"",type:"",unit:"",amount:1,remark:"",editable:!0,isNew:!0})},remove:function(t){var e=this.dataSource.filter(function(e){return e.key!==t});this.dataSource=e},saveRow:function(t){var e=this.dataSource.filter(function(e){return e.key===t})[0];e.editable=!1,e.isNew=!1},edit:function(t){var e=this.dataSource.filter(function(e){return e.key===t})[0];e.editable=!e.editable},cancle:function(t){this.dataSource.filter(function(e){return e.key===t})[0].editable=!1},handlePlanChange:function(t,e,n){var a=[].concat(i()(this.dataSource)),o=a.filter(function(t){return e===t.key})[0];o&&(o[n]=t,this.dataSource=a)}}},p={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("a-drawer",{staticStyle:{height:"calc(100% - 55px)",overflow:"auto","padding-bottom":"53px"},attrs:{title:"新增办公用品申请",maskClosable:!1,width:"920",placement:"right",closable:!1,visible:t.officeSuppliesAddVisiable},on:{close:t.onClose}},[n("a-table",{attrs:{columns:t.columns,dataSource:t.dataSource,pagination:!1},scopedSlots:t._u([t._l(["name","type","amount","unit","remark"],function(e,a){return{key:e,fn:function(i,o){return[o.editable?n("a-input",{key:e,staticStyle:{margin:"-5px 0"},attrs:{value:i,placeholder:t.columns[a].title},on:{change:function(n){return t.handlePlanChange(n.target.value,o.key,e)}}}):[t._v(t._s(i))]]}}}),{key:"amount",fn:function(e,a){return[a.editable||a.isNew?[n("a-input-number",{attrs:{min:.01,precision:2,formatter:function(t){return t},placeholder:"数量"},model:{value:a.amount,callback:function(e){t.$set(a,"amount",e)},expression:"record.amount"}})]:n("span",[t._v(t._s(e))])]}},{key:"operation",fn:function(e,a){return[a.editable?[a.isNew?n("span",[n("a",{on:{click:function(e){return t.saveRow(a.key)}}},[t._v("添加")]),t._v(" "),n("a-divider",{attrs:{type:"vertical"}}),t._v(" "),n("a-popconfirm",{attrs:{title:"是否要删除此行？"},on:{confirm:function(e){return t.remove(a.key)}}},[n("a",[t._v("删除")])])],1):n("span",[n("a",{on:{click:function(e){return t.saveRow(a.key)}}},[t._v("保存")]),t._v(" "),n("a-divider",{attrs:{type:"vertical"}}),t._v(" "),n("a",{on:{click:function(e){return t.cancle(a.key)}}},[t._v("取消")])],1)]:n("span",[n("a",{on:{click:function(e){return t.edit(a.key)}}},[t._v("编辑")]),t._v(" "),n("a-divider",{attrs:{type:"vertical"}}),t._v(" "),n("a-popconfirm",{attrs:{title:"是否要删除此行？"},on:{confirm:function(e){return t.remove(a.key)}}},[n("a",[t._v("删除")])])],1)]}}],null,!0)}),t._v(" "),n("a-button",{staticStyle:{width:"100%","margin-top":"16px","margin-bottom":"8px"},attrs:{type:"dashed",icon:"plus"},on:{click:t.newRow}},[t._v("新增物品")]),t._v(" "),n("div",{staticClass:"drawer-bootom-button"},[n("a-popconfirm",{attrs:{title:"确定放弃编辑？",okText:"确定",cancelText:"取消"},on:{confirm:t.onClose}},[n("a-button",{staticStyle:{"margin-right":".8rem"}},[t._v("取消")])],1),t._v(" "),n("a-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.handleSubmit}},[t._v("提交")])],1)],1)},staticRenderFns:[]},f=n("VU/8")(d,p,!1,function(t){n("ITj1")},"data-v-b0a6ac58",null);e.default=f.exports}});